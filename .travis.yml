language: node_js

node_js:
  - "0.8.14"

env:
   global:
    - secure: "mYOC6dG49YEyF6vyV2OyBHdAt7tj+zRFWIjgYy7njP921e0TiaNumMa+FqMzlJLBW8eu3v4CnskXshgSqOjY9KqqszRW9x29gTwFPdqFuAcCvHYXq1zTY92SBXjTCJ1le7rbp9Z93iLErWFhsPhdu3jsUucNvGvT8nHbf4+s0eA="
    - secure: "uZvQQDkK20nuxTgccON7G242q/DzuL8qdGJ7XSRnmIoLJ9h4IMZh34F5fqCMjSKZ7TGSBHe4DpHw9xTu9lqnjJlNoRtFwRFg/m69R2olqqe//O1/21cmESvz4vYB3U0dtnaz8cPHTHlfri0E5lA7WjyvFQK6Xf4axmPIEZoKxlY="

install:
  - git checkout master
#  - gem install sass
#  - BRANCH_NAME=build/`eval date +%Y-%m-%d"T"%H-%M-%S`
  - TIME_STR=`eval date` 
#  - git checkout -b $BRANCH_NAME
  - npm install -g grunt-cli
  - npm install

#script:
#  - grunt travis
  
after_script:
  - git config --global user.email "$EMAIL"
  - git config --global user.name "$USER_NAME"
  - git remote add github https://okossuth:$PASSWORD@github.com/okossuth/nodejs-demo.git
  - git add .
#  - git reset app/dist/ovivo-desktop-employee-require.js.map
  - git commit -m "Travis CI build on $TIME_STR"
  - git push github master
  - wget https://s3.amazonaws.com/ovivo-beanstalk/AWSbean.tar.gz
  - tar xfvz AWSbean.tar.gz
  - export PATH=$PATH:$PWD/AWS-ElasticBeanstalk-CLI-2.5.1/eb/linux/python2.7
#  - eb status
  - eb init -I $AWSAKEY -S $AWSSKEY -a oskar -e oskar-env --region "eu-west-1" -s "64bit Amazon Linux running Node.js"
  - eb start -f

branches:
  only:
    - master

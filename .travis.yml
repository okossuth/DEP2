language: node_js

node_js:
  - "0.8.14"

env:
   global:
    - secure: "iT0Z8F0GtQNXbOWdRssRApmsUbyaOUo70eapavwcoDfX3x18EU6SI2wYtT/9Fd3DfHtd8UvSIdkB/VpNdBBb5UmfgDYyYc91yvfON1MfIrlN6pGzbIxnMmJ0np30XIdFxxmOuiWwN4N4D8WoQa4/i9cEEMmvWtrC4TtwLm3kapA="
    - secure: "LxxGmkFK+kCES3CuurVojqf6Ignv6WeiXe4nD2vPhMig70a4YKmaBf2zg3MKmqrMBRBe+kd2fv99B2xmgZnasLBw104dKj+mnAChocd6DCm18ziI12U9VVFF2hK+7m9BdSqUMPPPxS//ogKskJN4wyXbvoaQINlOIZGDdKfp9m0="

install:
  - git checkout master
#  - gem install sass
#  - BRANCH_NAME=build/`eval date +%Y-%m-%d"T"%H-%M-%S`
  - TIME_STR=`eval date` 
#  - git checkout -b $BRANCH_NAME
  - npm install -g grunt-cli
  - npm install

#script:
#  - grunt travis
  
after_script:
  - git config --global user.email "$EMAIL"
  - git config --global user.name "$USER_NAME"
  - git remote add github https://okossuth:$PASSWORD@github.com/okossuth/nodejs-demo.git
  - git add .
#  - git reset app/dist/ovivo-desktop-employee-require.js.map
  - git commit -m "Travis CI build on $TIME_STR"
  - git push github master
  - wget https://s3.amazonaws.com/ovivo-beanstalk/AWSbean.tar.gz
  - tar xfvz AWSbean.tar.gz
  - export PATH=$PATH:$PWD/AWS-ElasticBeanstalk-CLI-2.5.1/eb/linux/python2.7
#  - eb status
  - eb init -I $AWSAKEY -S $AWSSKEY -a oskar -e oskar-env --region "eu-west-1" -s "64bit Amazon Linux running Node.js"
  - eb start -f

branches:
  only:
    - master
